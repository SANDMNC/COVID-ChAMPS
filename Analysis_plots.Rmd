
```{r setup, include=FALSE}

#setwd("/Volumes/Groups/Adaptdir/COVID-CHAMPS/Data")
covid_data_child <- read.csv("covid_data_child_scored.csv", header=TRUE, stringsAsFactors = FALSE)

#read in packages
library(tidyverse)
library(interactions)
library(ggplot2)
library(jtools) #apa theme
library(ggpubr) #ggarrange

```


```{r, echo=FALSE, warning=FALSE}
#theme_set(
 # theme_bw() 
#)

#Change settings regarding theme here
apatheme=theme_bw()+
  theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        panel.border=element_blank(),
        axis.line=element_line(),
        text=element_text(family='Times'),
        legend.title=element_blank())

# covid distress ------------------------------------------------

p1<- ggplot(covid_data_child, aes(x = totalcov_dist, y = SDQhyp2)) +
geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Total COVID Negative Impact", y = "Change in Inattention-Hyperactivity") +
  apatheme

p2 <- ggplot(covid_data_child, aes(x = totalcov_dist, y = SDQcon2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Total COVID Negative Impact", y = "Change in Conduct Problems")  +
  apatheme

p3 <- ggplot(covid_data_child, aes(x = totalcov_dist, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Total COVID Negative Impact", y = "Trauma Symptoms") +
  apatheme

#put these 3 plots in a row in one figure
figure1 <- ggarrange(p1, p2, p3,
                    labels = c("A", "B", "C"),
                    ncol = 3, nrow = 1)
figure1

ggplot(covid_data_child, aes(x = totalcov_dist, y = SDQemo2, color = SDQemo_cat, fill = SDQemo_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Total COVID Negative Impact", y = "Emotional problems") +
  scale_color_discrete(name="Baseline SDQ\nEmotional Problems",
                           breaks=c("Average", "High", "S_raised"),
                           labels=c("Average", "High", "Slightly Raised")) +
  scale_fill_discrete(name="Baseline SDQ\nEmotional Problems",
                          breaks=c("Average", "High", "S_raised"),
                          labels=c("Average", "High", "Slightly Raised"))  +
  apatheme

ggplot(covid_data_child, aes(x = covid_pos_num, y = SDQpeer2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Total COVID Positive Impact", y = "Change in Peer Problems")  +
  apatheme

# DASS -------------------------------------------------------------------

DASSp1 <- ggplot(covid_data_child, aes(x = DASSDep, y = SDQemo2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Depressive Symptoms", y = "Change in Emotional Problems")  +
  apatheme

DASSp2 <- ggplot(covid_data_child, aes(x = DASSDep, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Depressive Symptoms", y = "Trauma Symptoms") +
  apatheme

DASSp3 <- ggplot(covid_data_child, aes(x = DASSAnx, y = SDQemo2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Anxiety Symptoms", y = "Change in Emotional Problems") +
  apatheme

DASSp4 <- ggplot(covid_data_child, aes(x = DASSAnx, y = SDQpeer2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Anxiety Symptoms", y = "Change in Peer Problems") +
  apatheme

DASSp5 <- ggplot(covid_data_child, aes(x = DASSStress, y = SDQpeer2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Stress", y = "Change in Peer Problems") +
  apatheme

DASSp6 <- ggplot(covid_data_child, aes(x = DASSStress, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Stress", y = "Trauma Symptoms")  +
  apatheme


#put these 6 plots in a row in one figure
figureDASS <- ggarrange(DASSp1, DASSp2, DASSp3, DASSp4, DASSp5, DASSp6,
                    labels = c("A", "B", "C", "D", "E", "F"),
                    ncol = 2, nrow = 3)
figureDASS

#Sarah I made the extra DASS plots to fit into a complete grid in case you want them
DASSp7 <- ggplot(covid_data_child, aes(x = DASSDep, y = SDQpeer2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Depressive Symptoms", y = "Change in Peer Problems") +
  apatheme

DASSp8 <- ggplot(covid_data_child, aes(x = DASSAnx, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Anxiety Symptoms", y = "Trauma Symptoms") +
  apatheme

DASSp9 <- ggplot(covid_data_child, aes(x = DASSStress, y = SDQemo2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parent Stress", y = "Change in Emotional Problems") +
  apatheme

#add in the extra plotsa to make a 3x3 grid
figurefullDASS <- ggarrange(DASSp1, DASSp7, DASSp2, DASSp3, DASSp4, DASSp8, DASSp9, DASSp5, DASSp6,
                    labels = c("A", "B", "C", "D", "E", "F", "G", "H", "I"),
                    ncol = 3, nrow = 3)
figurefullDASS


stressp1<- ggplot(covid_data_child, aes(x = DASSStress, y = SDQemo2, color = SDQemo_cat, fill = SDQemo_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parent Stress", y = "Change in Emotional problems") +
  scale_color_discrete(name="Baseline SDQ\nEmotional Problems",
                       breaks=c("Average", "High", "S_raised"),
                       labels=c("Average", "High", "Slightly Raised")) +
  scale_fill_discrete(name="Baseline SDQ\nEmotional Problems",
                      breaks=c("Average", "High", "S_raised"),
                      labels=c("Average", "High", "Slightly Raised"))  +
  apatheme +
  theme(axis.title.x=element_blank(), panel.border=element_blank())

stressp2<- ggplot(covid_data_child, aes(x = DASSStress, y = SDQcon2, color = SDQcon_cat, fill = SDQcon_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parent Stress", y = "Change in Conduct problems") +
  scale_color_discrete(name="Baseline SDQ\nConduct Problems",
                       breaks=c("Average", "High", "S_raised"),
                       labels=c("Average", "High", "Slightly Raised")) +
  scale_fill_discrete(name="Baseline SDQ\nConduct Problems",
                      breaks=c("Average", "High", "S_raised"),
                      labels=c("Average", "High", "Slightly Raised"))  +
  apatheme +
  theme(axis.title.x=element_blank())


covid_data_child$ch_age_cat <- as.factor(car::recode(covid_data_child$ch_age, "NA=NA; 0:8='5-8';9:13='9-13'; else='14-17'"))
table(covid_data_child$ch_age_cat, useNA = "ifany")

stressp3<- ggplot(covid_data_child, aes(x = DASSStress, y = SDQhyp2, color = ch_age_cat, fill = ch_age_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parent Stress", y = "Change in Inattention-Hyperactivity Problems") +
  scale_color_discrete(name="Child Age",
                       breaks=c("14-17", "9-13", "5-8"),
                       labels=c("14-17", "9-13", "5-8")) +
  scale_fill_discrete(name="Child Age",
                      breaks=c("14-17", "9-13", "5-8"),
                      labels=c("14-17", "9-13", "5-8"))  +
  apatheme

figurestress <- ggarrange(stressp1, stressp2, stressp3,
                    labels = c("A", "B", "C"),
                    ncol = 1, nrow = 3)
figurestress

# Parenting -----------------------------------------------------------------------------

ggplot(covid_data_child, aes(x = PARQhostile, y = SDQhyp2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parental Hostility", y = "Change in Inattention-Hyperactivity")

ggplot(covid_data_child, aes(x = PARQhostile, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Parental Hostility", y = "Trauma Symptoms")

ggplot(covid_data_child, aes(x = PARQhostile, y = SDQcon2, color = SDQcon_cat, fill = SDQcon_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parental Hostility", y = "Change in Conduct problems") +
  scale_color_discrete(name="Baseline SDQ\nConduct Problems",
                       breaks=c("Average", "High", "S_raised"),
                       labels=c("Average", "High", "Slightly Raised")) +
  scale_fill_discrete(name="Baseline SDQ\nConduct Problems",
                      breaks=c("Average", "High", "S_raised"),
                      labels=c("Average", "High", "Slightly Raised"))

ggplot(covid_data_child, aes(x = PARQwarmth, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Low Parental Warmth", y = "Trauma Symptoms")

ggplot(covid_data_child, aes(x = totalFES, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Family Cohesion", y = "Trauma Symptoms")

ggplot(covid_data_child, aes(x = totalFES, y = SDQpeer2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Family Cohesion", y = "Change in Peer Problems")



# Communication -----------------------------------------------------------

Comm1 <- ggplot(covid_data_child, aes(x = emotion_comm, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Emotion-focused Communication", y = "Trauma Symptoms") +
  apatheme

Comm3 <- ggplot(covid_data_child, aes(x = emotion_comm, y = SDQhyp2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Emotion-focused Communication", y = "Change in Inattention-Hyperactivity Problems") +
  apatheme

Comm2 <- ggplot(covid_data_child, aes(x = emotion_comm, y = SDQemo2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Emotion-focused Communication", y = "Change in Emotional Problems") +
  apatheme

Comm4 <- ggplot(covid_data_child, aes(x = emotion_comm, y = SDQpeer2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Emotion-focused Communication", y = "Change in Peer Problems") +
  apatheme

Comm6 <- ggplot(covid_data_child, aes(x = self_comm, y = SDQemo2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Self-focused Communication", y = "Change in Emotional Problems") +
  apatheme

Comm8 <- ggplot(covid_data_child, aes(x = self_comm, y = SDQcon2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Self-focused Communication", y = "Change in Conduct Problems") +
  apatheme

Comm7 <- ggplot(covid_data_child, aes(x = self_comm, y = SDQhyp2)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Self-focused Communication", y = "Change in Inattention-Hyperactivity Problems") +
  apatheme

Comm5 <- ggplot(covid_data_child, aes(x = self_comm, y = totalPTSD)) +
  geom_jitter(color = "#00CC99", size = 1.5, shape = 23) +
  geom_smooth(color = "#00AFBB", fill = "#00AFBB", method = lm) +
  labs(x = "Self-focused Communication", y = "Trauma Symptoms") +
  apatheme

figurecomm <- ggarrange(Comm1, Comm2, Comm3, Comm4, Comm5, Comm6, Comm7, Comm8,
                    labels = c("A", "B", "C", "D", "E", "F", "G", "H"),
                    ncol = 4, nrow = 2)
figurecomm

# Moderating influence of SES -------------------------------------------------

covid_data_child$income_famsize_cat <- as.factor(car::recode(covid_data_child$income_famsize, "NA=NA; 0:51430='Low';else='High'"))
table(covid_data_child$income_famsize_cat, useNA = "ifany")

ggplot(data=subset(covid_data_child, !is.na(income_famsize_cat)), aes(x = PARQhostile, y = totalPTSD, color = income_famsize_cat, fill = income_famsize_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parental Hostility", y = "Trauma Symptoms") +
  scale_color_discrete(name="Income-to-needs",
                       breaks=c("High", "Low"),
                       labels=c("High", "Low")) +
  scale_fill_discrete(name="Income-to-needs",
                      breaks=c("High", "Low"),
                      labels=c("High", "Low"))

ggplot(data=subset(covid_data_child, !is.na(income_famsize_cat)), aes(x = PARQwarmth, y = totalPTSD, color = income_famsize_cat, fill = income_famsize_cat)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Low Parental Warmth", y = "Trauma Symptoms") +
  scale_color_discrete(name="Income-to-needs",
                       breaks=c("High", "Low"),
                       labels=c("High", "Low")) +
  scale_fill_discrete(name="Income-to-needs",
                      breaks=c("High", "Low"),
                      labels=c("High", "Low"))

covid_data_child$par_ed_ord_cat <- as.factor(car::recode(covid_data_child$par_ed_ord, "NA=NA; 1:5='Low';else='High'"))
table(covid_data_child$par_ed_ord_cat, useNA = "ifany")

ggplot(covid_data_child, aes(x = PARQhostile, y = totalPTSD, color = other_par, fill = other_par)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parental Hostility", y = "Trauma Symptoms") +
  scale_color_discrete(name="Two parents/caregivers in the home",
                       breaks=c("Yes", "No"),
                       labels=c("Yes", "No")) +
  scale_fill_discrete(name="Two parents/caregivers in the home",
                      breaks=c("Yes", "No"),
                      labels=c("Yes", "No"))

ggplot(covid_data_child, aes(x = DASSAnx, y = SDQpeer2, color = other_par, fill = other_par)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parent Anxiety", y = "Change in Peer Problems") +
  scale_color_discrete(name="Two parents/caregivers in the home",
                       breaks=c("Yes", "No"),
                       labels=c("Yes", "No")) +
  scale_fill_discrete(name="Two parents/caregivers in the home",
                      breaks=c("Yes", "No"),
                      labels=c("Yes", "No"))

ggplot(data=subset(covid_data_child, !is.na(other_par)), aes(x = DASSStress, y = SDQcon2, color = SDQcon_cat, fill = SDQcon_cat)) +
  geom_jitter(size = 1.5, shape = 23, na.rm = TRUE) +
  geom_smooth(method = lm) +
  labs(x = "Parent Stress", y = "Change in Conduct problems") +
  scale_color_discrete(name="Baseline SDQ\nConduct Problems",
                       breaks=c("Average", "High", "S_raised"),
                       labels=c("Average", "High", "Slightly Raised")) +
  scale_fill_discrete(name="Baseline SDQ\nConduct Problems",
                      breaks=c("Average", "High", "S_raised"),
                      labels=c("Average", "High", "Slightly Raised")) +
  facet_wrap(~other_par)

ggplot(covid_data_child, aes(x = DASSStress, y = SDQpeer2, color = other_par, fill = other_par)) +
  geom_jitter(size = 1.5, shape = 23) +
  geom_smooth(method = lm) +
  labs(x = "Parent Stress", y = "Change in Peer Problems") +
  scale_color_discrete(name="Two parents/caregivers in the home",
                       breaks=c("Yes", "No"),
                       labels=c("Yes", "No")) +
  scale_fill_discrete(name="Two parents/caregivers in the home",
                      breaks=c("Yes", "No"),
                      labels=c("Yes", "No"))

```
